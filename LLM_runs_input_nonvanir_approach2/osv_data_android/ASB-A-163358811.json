{
  "id": "ASB-A-163358811",
  "details": "In onTargetSelected of ResolverActivity.java, there is a possible settings bypass allowing an app to become the default handler for arbitrary domains. This could lead to local escalation of privilege with User execution privileges needed. User interaction is not needed for exploitation.",
  "aliases": [
    "A-163358811",
    "CVE-2021-0334"
  ],
  "modified": "2024-08-07T19:29:27.216907Z",
  "published": "2021-02-01T00:00:00Z",
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://source.android.com/security/bulletin/2021-02-01"
    },
    {
      "type": "FIX",
      "url": "https://android.googlesource.com/platform/frameworks/base/+/251dfbee7fb5986c7e93362556ea556785e4d0e4"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "platform/frameworks/base",
        "ecosystem": "Android"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "8.0:0"
            },
            {
              "fixed": "8.0:2021-02-01"
            }
          ]
        }
      ],
      "versions": [
        "8.0"
      ],
      "ecosystem_specific": {
        "vanir_signatures": [
          {
            "digest": {
              "threshold": 0.9,
              "line_hashes": [
                "174371553732100889283254511614136005441",
                "13330894795705433851892047269793446799",
                "201994403411096622710607662506332749494",
                "134510787689246407431920260464135272370",
                "333301721987638033010754890503292933194",
                "334421543523570617777152532351159328443",
                "46504565387357307030054830023679990582",
                "211255316221032162905081300686009719926",
                "247284402298655770418265826111420868310",
                "272831955049442656560451445653716304708",
                "5834475539267677776199645141465132214",
                "119681882521869389982210889803274217724",
                "219116227868864441301067429919611919680",
                "33393003783262160847678859101194228440",
                "60363212111710427479805791938696258310",
                "188605675358477518837422141341530750606",
                "276088793410760290443735272149674200612",
                "339988031543743852047813282201495733879"
              ]
            },
            "id": "ASB-A-163358811-2b267d55",
            "source": "https://android.googlesource.com/platform/frameworks/base/+/251dfbee7fb5986c7e93362556ea556785e4d0e4",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "core/java/com/android/internal/app/ResolverActivity.java"
            },
            "signature_type": "Line"
          },
          {
            "digest": {
              "length": 4170.0,
              "function_hash": "298730487644032992607579790542590767991"
            },
            "id": "ASB-A-163358811-ba2b7484",
            "source": "https://android.googlesource.com/platform/frameworks/base/+/251dfbee7fb5986c7e93362556ea556785e4d0e4",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "core/java/com/android/internal/app/ResolverActivity.java",
              "function": "onTargetSelected"
            },
            "signature_type": "Function"
          }
        ],
        "fixes": [
          "https://android.googlesource.com/platform/frameworks/base/+/251dfbee7fb5986c7e93362556ea556785e4d0e4"
        ],
        "spl": "2021-02-01",
        "severity": "High",
        "types": [
          "EoP"
        ]
      },
      "database_specific": {
        "source": "https://storage.googleapis.com/android-osv/ASB-A-163358811.json"
      }
    },
    {
      "package": {
        "name": "platform/frameworks/base",
        "ecosystem": "Android"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "8.1:0"
            },
            {
              "fixed": "8.1:2021-02-01"
            }
          ]
        }
      ],
      "versions": [
        "8.1"
      ],
      "ecosystem_specific": {
        "vanir_signatures": [
          {
            "digest": {
              "length": 4170.0,
              "function_hash": "298730487644032992607579790542590767991"
            },
            "id": "ASB-A-163358811-65fcabd5",
            "source": "https://android.googlesource.com/platform/frameworks/base/+/251dfbee7fb5986c7e93362556ea556785e4d0e4",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "core/java/com/android/internal/app/ResolverActivity.java",
              "function": "onTargetSelected"
            },
            "signature_type": "Function"
          },
          {
            "digest": {
              "threshold": 0.9,
              "line_hashes": [
                "174371553732100889283254511614136005441",
                "13330894795705433851892047269793446799",
                "201994403411096622710607662506332749494",
                "134510787689246407431920260464135272370",
                "333301721987638033010754890503292933194",
                "334421543523570617777152532351159328443",
                "46504565387357307030054830023679990582",
                "211255316221032162905081300686009719926",
                "247284402298655770418265826111420868310",
                "272831955049442656560451445653716304708",
                "5834475539267677776199645141465132214",
                "119681882521869389982210889803274217724",
                "219116227868864441301067429919611919680",
                "33393003783262160847678859101194228440",
                "60363212111710427479805791938696258310",
                "188605675358477518837422141341530750606",
                "276088793410760290443735272149674200612",
                "339988031543743852047813282201495733879"
              ]
            },
            "id": "ASB-A-163358811-cc0f08e1",
            "source": "https://android.googlesource.com/platform/frameworks/base/+/251dfbee7fb5986c7e93362556ea556785e4d0e4",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "core/java/com/android/internal/app/ResolverActivity.java"
            },
            "signature_type": "Line"
          }
        ],
        "fixes": [
          "https://android.googlesource.com/platform/frameworks/base/+/251dfbee7fb5986c7e93362556ea556785e4d0e4"
        ],
        "spl": "2021-02-01",
        "severity": "High",
        "types": [
          "EoP"
        ]
      },
      "database_specific": {
        "source": "https://storage.googleapis.com/android-osv/ASB-A-163358811.json"
      }
    },
    {
      "package": {
        "name": "platform/frameworks/base",
        "ecosystem": "Android"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "9:0"
            },
            {
              "fixed": "9:2021-02-01"
            }
          ]
        }
      ],
      "versions": [
        "9"
      ],
      "ecosystem_specific": {
        "vanir_signatures": [
          {
            "digest": {
              "length": 4170.0,
              "function_hash": "298730487644032992607579790542590767991"
            },
            "id": "ASB-A-163358811-20002b59",
            "source": "https://android.googlesource.com/platform/frameworks/base/+/251dfbee7fb5986c7e93362556ea556785e4d0e4",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "core/java/com/android/internal/app/ResolverActivity.java",
              "function": "onTargetSelected"
            },
            "signature_type": "Function"
          },
          {
            "digest": {
              "threshold": 0.9,
              "line_hashes": [
                "174371553732100889283254511614136005441",
                "13330894795705433851892047269793446799",
                "201994403411096622710607662506332749494",
                "134510787689246407431920260464135272370",
                "333301721987638033010754890503292933194",
                "334421543523570617777152532351159328443",
                "46504565387357307030054830023679990582",
                "211255316221032162905081300686009719926",
                "247284402298655770418265826111420868310",
                "272831955049442656560451445653716304708",
                "5834475539267677776199645141465132214",
                "119681882521869389982210889803274217724",
                "219116227868864441301067429919611919680",
                "33393003783262160847678859101194228440",
                "60363212111710427479805791938696258310",
                "188605675358477518837422141341530750606",
                "276088793410760290443735272149674200612",
                "339988031543743852047813282201495733879"
              ]
            },
            "id": "ASB-A-163358811-8d8ef0dd",
            "source": "https://android.googlesource.com/platform/frameworks/base/+/251dfbee7fb5986c7e93362556ea556785e4d0e4",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "core/java/com/android/internal/app/ResolverActivity.java"
            },
            "signature_type": "Line"
          }
        ],
        "fixes": [
          "https://android.googlesource.com/platform/frameworks/base/+/251dfbee7fb5986c7e93362556ea556785e4d0e4"
        ],
        "spl": "2021-02-01",
        "severity": "High",
        "types": [
          "EoP"
        ]
      },
      "database_specific": {
        "source": "https://storage.googleapis.com/android-osv/ASB-A-163358811.json"
      }
    },
    {
      "package": {
        "name": "platform/frameworks/base",
        "ecosystem": "Android"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "10:0"
            },
            {
              "fixed": "10:2021-02-01"
            }
          ]
        }
      ],
      "versions": [
        "10"
      ],
      "ecosystem_specific": {
        "vanir_signatures": [
          {
            "digest": {
              "threshold": 0.9,
              "line_hashes": [
                "174371553732100889283254511614136005441",
                "13330894795705433851892047269793446799",
                "201994403411096622710607662506332749494",
                "134510787689246407431920260464135272370",
                "333301721987638033010754890503292933194",
                "334421543523570617777152532351159328443",
                "46504565387357307030054830023679990582",
                "211255316221032162905081300686009719926",
                "247284402298655770418265826111420868310",
                "272831955049442656560451445653716304708",
                "5834475539267677776199645141465132214",
                "119681882521869389982210889803274217724",
                "219116227868864441301067429919611919680",
                "33393003783262160847678859101194228440",
                "60363212111710427479805791938696258310",
                "188605675358477518837422141341530750606",
                "276088793410760290443735272149674200612",
                "339988031543743852047813282201495733879"
              ]
            },
            "id": "ASB-A-163358811-1a82efa1",
            "source": "https://android.googlesource.com/platform/frameworks/base/+/251dfbee7fb5986c7e93362556ea556785e4d0e4",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "core/java/com/android/internal/app/ResolverActivity.java"
            },
            "signature_type": "Line"
          },
          {
            "digest": {
              "length": 4170.0,
              "function_hash": "298730487644032992607579790542590767991"
            },
            "id": "ASB-A-163358811-a39901d1",
            "source": "https://android.googlesource.com/platform/frameworks/base/+/251dfbee7fb5986c7e93362556ea556785e4d0e4",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "core/java/com/android/internal/app/ResolverActivity.java",
              "function": "onTargetSelected"
            },
            "signature_type": "Function"
          }
        ],
        "fixes": [
          "https://android.googlesource.com/platform/frameworks/base/+/251dfbee7fb5986c7e93362556ea556785e4d0e4"
        ],
        "spl": "2021-02-01",
        "severity": "High",
        "types": [
          "EoP"
        ]
      },
      "database_specific": {
        "source": "https://storage.googleapis.com/android-osv/ASB-A-163358811.json"
      }
    },
    {
      "package": {
        "name": "platform/frameworks/base",
        "ecosystem": "Android"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "11:0"
            },
            {
              "fixed": "11:2021-02-01"
            }
          ]
        }
      ],
      "versions": [
        "11"
      ],
      "ecosystem_specific": {
        "vanir_signatures": [
          {
            "digest": {
              "length": 4170.0,
              "function_hash": "298730487644032992607579790542590767991"
            },
            "id": "ASB-A-163358811-a72df64f",
            "source": "https://android.googlesource.com/platform/frameworks/base/+/251dfbee7fb5986c7e93362556ea556785e4d0e4",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "core/java/com/android/internal/app/ResolverActivity.java",
              "function": "onTargetSelected"
            },
            "signature_type": "Function"
          },
          {
            "digest": {
              "threshold": 0.9,
              "line_hashes": [
                "174371553732100889283254511614136005441",
                "13330894795705433851892047269793446799",
                "201994403411096622710607662506332749494",
                "134510787689246407431920260464135272370",
                "333301721987638033010754890503292933194",
                "334421543523570617777152532351159328443",
                "46504565387357307030054830023679990582",
                "211255316221032162905081300686009719926",
                "247284402298655770418265826111420868310",
                "272831955049442656560451445653716304708",
                "5834475539267677776199645141465132214",
                "119681882521869389982210889803274217724",
                "219116227868864441301067429919611919680",
                "33393003783262160847678859101194228440",
                "60363212111710427479805791938696258310",
                "188605675358477518837422141341530750606",
                "276088793410760290443735272149674200612",
                "339988031543743852047813282201495733879"
              ]
            },
            "id": "ASB-A-163358811-b4d67a45",
            "source": "https://android.googlesource.com/platform/frameworks/base/+/251dfbee7fb5986c7e93362556ea556785e4d0e4",
            "deprecated": false,
            "signature_version": "v1",
            "target": {
              "file": "core/java/com/android/internal/app/ResolverActivity.java"
            },
            "signature_type": "Line"
          }
        ],
        "fixes": [
          "https://android.googlesource.com/platform/frameworks/base/+/251dfbee7fb5986c7e93362556ea556785e4d0e4"
        ],
        "spl": "2021-02-01",
        "severity": "High",
        "types": [
          "EoP"
        ]
      },
      "database_specific": {
        "source": "https://storage.googleapis.com/android-osv/ASB-A-163358811.json"
      }
    }
  ],
  "schema_version": "1.6.0"
}