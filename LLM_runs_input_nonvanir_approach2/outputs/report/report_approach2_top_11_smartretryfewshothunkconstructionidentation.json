{
    "run_timestamp": "20250605_213732",
    "target_downstream_version": "all_versions",
    "input_json_file": "inputs/top_11_vulns_2425.json",
    "main_output_json_file_with_diffs": "outputs/approach2_top_11_smartretryfewshothunkconstructionidentation.json",
    "summary": {
        "total_file_conflicts_matching_version": 36,
        "files_attempted_for_llm_diff_generation": 36,
        "files_with_llm_diff_successfully_generated": 16,
        "files_skipped_pre_llm_call": 0,
        "files_with_llm_diff_generation_errors_or_skipped_in_func": 20,
        "successful_attempts_histogram": {
            "1 run": 9,
            "2 runs": 2,
            "3 runs": 5
        },
        "total_runtime_seconds_all": 10805.130000000001,
        "total_runtime_seconds_successful": 3624.3399999999997,
        "total_gemini_input_tokens": 5072927,
        "total_gemini_output_tokens": 62507,
        "total_gemini_tokens": 6225046
    },
    "successfully_generated_diffs_log": [
        {
            "vulnerability_id": "ASB-A-333364513",
            "file_name": "src/com/android/settings/search/SearchResultTrampoline.java",
            "patch_sha": "ddc11bc03ab48e885f652b89df5f92ff283bcd4a",
            "downstream_version": "14",
            "diff_preview": "```diff\n--- a/src/com/android/settings/search/SearchResultTrampoline.java\n+++ b/src/com/android/sett...",
            "token_counts": {
                "input": 24201,
                "output": 324,
                "total": 36264
            }
        },
        {
            "vulnerability_id": "ASB-A-333364513",
            "file_name": "src/com/android/settings/search/SearchResultTrampoline.java",
            "patch_sha": "8bdbb580da847d82f16fb57883a01a5e65ffa696",
            "downstream_version": "12L",
            "diff_preview": "```diff\n--- a/src/com/android/settings/search/SearchResultTrampoline.java\n+++ b/src/com/android/sett...",
            "token_counts": {
                "input": 24138,
                "output": 463,
                "total": 37772
            }
        },
        {
            "vulnerability_id": "ASB-A-353712853",
            "file_name": "services/usb/java/com/android/server/usb/UsbDeviceManager.java",
            "patch_sha": "37be5d18e529877fcd3c62063aec205a96660449",
            "downstream_version": "14",
            "diff_preview": "```diff\n--- a/services/usb/java/com/android/server/usb/UsbDeviceManager.java\n+++ b/services/usb/java...",
            "token_counts": {
                "input": 94535,
                "output": 256,
                "total": 113529
            }
        },
        {
            "vulnerability_id": "ASB-A-353712853",
            "file_name": "services/usb/java/com/android/server/usb/UsbDeviceManager.java",
            "patch_sha": "aec6c731bfdbe7f0fe537948563a7aeee5cf05e2",
            "downstream_version": "13",
            "diff_preview": "```diff\n--- a/services/usb/java/com/android/server/usb/UsbDeviceManager.java\n+++ b/services/usb/java...",
            "token_counts": {
                "input": 92104,
                "output": 767,
                "total": 118418
            }
        },
        {
            "vulnerability_id": "ASB-A-353712853",
            "file_name": "services/usb/java/com/android/server/usb/UsbDeviceManager.java",
            "patch_sha": "643bea502a92329e72585050fb7fa5535456094f",
            "downstream_version": "12L",
            "diff_preview": "```diff\n--- a/services/usb/java/com/android/server/usb/UsbDeviceManager.java\n+++ b/services/usb/java...",
            "token_counts": {
                "input": 137723,
                "output": 1438,
                "total": 180702
            }
        },
        {
            "vulnerability_id": "ASB-A-382064697",
            "file_name": "services/devicepolicy/java/com/android/server/devicepolicy/DevicePolicyManagerService.java",
            "patch_sha": "3461e84908b46b6fe82ac391d43a43f23c0b1d3e",
            "downstream_version": "14",
            "diff_preview": "```diff\n--- a/services/devicepolicy/java/com/android/server/devicepolicy/DevicePolicyManagerService....",
            "token_counts": {
                "input": 825396,
                "output": 1507,
                "total": 889875
            }
        },
        {
            "vulnerability_id": "ASB-A-382064697",
            "file_name": "services/devicepolicy/java/com/android/server/devicepolicy/DevicePolicyManagerService.java",
            "patch_sha": "3298a1c9eb899d02e532f5dcf88904640a626dcd",
            "downstream_version": "13",
            "diff_preview": "```diff\n--- a/services/devicepolicy/java/com/android/server/devicepolicy/DevicePolicyManagerService....",
            "token_counts": {
                "input": 644253,
                "output": 1956,
                "total": 674651
            }
        },
        {
            "vulnerability_id": "ASB-A-307948424",
            "file_name": "services/core/java/com/android/server/notification/SnoozeHelper.java",
            "patch_sha": "ade22bfdf6698cb97b4edc303e8952d6cc1a2f73",
            "downstream_version": "13",
            "diff_preview": "```diff\n--- a/services/core/java/com/android/server/notification/SnoozeHelper.java\n+++ b/services/co...",
            "token_counts": {
                "input": 29794,
                "output": 359,
                "total": 43529
            }
        },
        {
            "vulnerability_id": "ASB-A-353240784",
            "file_name": "services/appwidget/java/com/android/server/appwidget/AppWidgetServiceImpl.java",
            "patch_sha": "ae39a3f6538e5a5a73aea4daf8b552539247227f",
            "downstream_version": "13",
            "diff_preview": "```diff\n--- a/services/appwidget/java/com/android/server/appwidget/AppWidgetServiceImpl.java\n+++ b/s...",
            "token_counts": {
                "input": 69524,
                "output": 617,
                "total": 80982
            }
        },
        {
            "vulnerability_id": "ASB-A-309938635",
            "file_name": "ojluni/src/main/java/java/util/zip/ZipFile.java",
            "patch_sha": "288a44a1817707110cdf5a3a6ef8377c6e10cce2",
            "downstream_version": "12L",
            "diff_preview": "```diff\n--- a/ojluni/src/main/java/java/util/zip/ZipFile.java\n+++ b/ojluni/src/main/java/java/util/z...",
            "token_counts": {
                "input": 31412,
                "output": 427,
                "total": 41391
            }
        },
        {
            "vulnerability_id": "ASB-A-309938635",
            "file_name": "ojluni/src/main/java/java/util/zip/ZipFile.java",
            "patch_sha": "288a44a1817707110cdf5a3a6ef8377c6e10cce2",
            "downstream_version": "13",
            "diff_preview": "```diff\n--- a/ojluni/src/main/java/java/util/zip/ZipFile.java\n+++ b/ojluni/src/main/java/java/util/z...",
            "token_counts": {
                "input": 95439,
                "output": 2071,
                "total": 137285
            }
        },
        {
            "vulnerability_id": "ASB-A-313428840",
            "file_name": "services/companion/java/com/android/server/companion/CompanionDeviceManagerService.java",
            "patch_sha": "1ae3b43c248cdf5ee63311f06acd0ee19d93f0cd",
            "downstream_version": "13",
            "diff_preview": "```diff\n--- a/services/companion/java/com/android/server/companion/CompanionDeviceManagerService.jav...",
            "token_counts": {
                "input": 33750,
                "output": 390,
                "total": 43578
            }
        },
        {
            "vulnerability_id": "ASB-A-314333719",
            "file_name": "packages/SystemUI/src/com/android/systemui/media/dagger/MediaModule.java",
            "patch_sha": "a441f4acd62cce1059818ce8e9b7ab93b0079e50",
            "downstream_version": "14",
            "diff_preview": "```diff\n--- a/packages/SystemUI/src/com/android/systemui/media/dagger/MediaModule.java\n+++ b/package...",
            "token_counts": {
                "input": 24230,
                "output": 143,
                "total": 37216
            }
        },
        {
            "vulnerability_id": "ASB-A-314333719",
            "file_name": "packages/SystemUI/src/com/android/systemui/media/dagger/MediaModule.java",
            "patch_sha": "346a778e609ee2109bc1917d7649b7db91e25cf4",
            "downstream_version": "12L",
            "diff_preview": "```diff\n--- a/packages/SystemUI/src/com/android/systemui/media/dagger/MediaModule.java\n+++ b/package...",
            "token_counts": {
                "input": 23563,
                "output": 125,
                "total": 33344
            }
        },
        {
            "vulnerability_id": "ASB-A-314333719",
            "file_name": "packages/SystemUI/src/com/android/systemui/media/dagger/MediaModule.java",
            "patch_sha": "0d533a9c5107d47d6259028f1371c9bba276bb40",
            "downstream_version": "12",
            "diff_preview": "```diff\n--- a/packages/SystemUI/src/com/android/systemui/media/dagger/MediaModule.java\n+++ b/package...",
            "token_counts": {
                "input": 23563,
                "output": 419,
                "total": 35787
            }
        },
        {
            "vulnerability_id": "ASB-A-230492947",
            "file_name": "services/core/java/com/android/server/wm/ActivityTaskManagerService.java",
            "patch_sha": "d8368be4f8fb7019ea24b4798f029301c704092c",
            "downstream_version": "11",
            "diff_preview": "```diff\n--- a/services/core/java/com/android/server/wm/ActivityTaskManagerService.java\n+++ b/service...",
            "token_counts": {
                "input": 285730,
                "output": 2254,
                "total": 314556
            }
        }
    ],
    "skipped_or_errored_diff_generation_log": [
        {
            "vulnerability_id": "ASB-A-333364513",
            "file_name": "src/com/android/settings/search/SearchResultTrampoline.java",
            "patch_sha": "8bdbb580da847d82f16fb57883a01a5e65ffa696",
            "reason": "Last Format Error: Invalid patch format: Hunk diff line expected: @@ -105,12 +105,11 @@\n, Last Apply Error: Skipped due to format error",
            "last_format_error": "Invalid patch format: Hunk diff line expected: @@ -105,12 +105,11 @@\n",
            "last_apply_error": "Skipped due to format error",
            "token_counts": {
                "input": 73240,
                "output": 1428,
                "total": 104822
            }
        },
        {
            "vulnerability_id": "ASB-A-333364513",
            "file_name": "src/com/android/settings/search/SearchResultTrampoline.java",
            "patch_sha": "b86569b274003e517bfd089cc7d6ba62d1c5f820",
            "reason": "Last Format Error: Invalid patch format: Hunk is longer than expected, Last Apply Error: Skipped due to format error",
            "last_format_error": "Invalid patch format: Hunk is longer than expected",
            "last_apply_error": "Skipped due to format error",
            "token_counts": {
                "input": 72328,
                "output": 2901,
                "total": 117379
            }
        },
        {
            "vulnerability_id": "ASB-A-353712853",
            "file_name": "services/usb/java/com/android/server/usb/UsbDeviceManager.java",
            "patch_sha": "ef6f37e5292ae3491de1857751dc01a319bb61d1",
            "reason": "Last Format Error: Invalid patch format: Hunk diff line expected: @@ -879,7 +880,7 @@\n, Last Apply Error: Skipped due to format error",
            "last_format_error": "Invalid patch format: Hunk diff line expected: @@ -879,7 +880,7 @@\n",
            "last_apply_error": "Skipped due to format error",
            "token_counts": {
                "input": 137384,
                "output": 1169,
                "total": 177192
            }
        },
        {
            "vulnerability_id": "ASB-A-300090204",
            "file_name": "core/java/android/service/dreams/DreamService.java",
            "patch_sha": "6926fd15fb16c51468dde270bd61ee68772b8c14",
            "reason": "Last Format Error: Invalid patch format: Unexpected hunk found: @@ -1075,3 +1087,97 @@ public class DreamService extends Service implements Window.Callback {\n, Last Apply Error: Skipped due to format error",
            "last_format_error": "Invalid patch format: Unexpected hunk found: @@ -1075,3 +1087,97 @@ public class DreamService extends Service implements Window.Callback {\n",
            "last_apply_error": "Skipped due to format error",
            "token_counts": {
                "input": 102967,
                "output": 4039,
                "total": 154171
            }
        },
        {
            "vulnerability_id": "ASB-A-300090204",
            "file_name": "core/java/android/service/dreams/DreamService.java",
            "patch_sha": "6926fd15fb16c51468dde270bd61ee68772b8c14",
            "reason": "Last Format Error: Invalid patch format: Hunk diff line expected: @@ -25,6 +30,7 @@\n, Last Apply Error: Skipped due to format error",
            "last_format_error": "Invalid patch format: Hunk diff line expected: @@ -25,6 +30,7 @@\n",
            "last_apply_error": "Skipped due to format error",
            "token_counts": {
                "input": 103627,
                "output": 4357,
                "total": 153009
            }
        },
        {
            "vulnerability_id": "ASB-A-300090204",
            "file_name": "core/java/android/service/dreams/DreamService.java",
            "patch_sha": "6926fd15fb16c51468dde270bd61ee68772b8c14",
            "reason": "Last Format Error: Invalid patch format: Hunk is longer than expected, Last Apply Error: Skipped due to format error",
            "last_format_error": "Invalid patch format: Hunk is longer than expected",
            "last_apply_error": "Skipped due to format error",
            "token_counts": {
                "input": 103158,
                "output": 3650,
                "total": 154819
            }
        },
        {
            "vulnerability_id": "ASB-A-307948424",
            "file_name": "services/core/java/com/android/server/notification/SnoozeHelper.java",
            "patch_sha": "ade22bfdf6698cb97b4edc303e8952d6cc1a2f73",
            "reason": "Last Format Error: Invalid patch format: Hunk diff line expected: @@ -375,10 +375,11 @@\n, Last Apply Error: Skipped due to format error",
            "last_format_error": "Invalid patch format: Hunk diff line expected: @@ -375,10 +375,11 @@\n",
            "last_apply_error": "Skipped due to format error",
            "token_counts": {
                "input": 90177,
                "output": 1472,
                "total": 123464
            }
        },
        {
            "vulnerability_id": "ASB-A-307948424",
            "file_name": "services/core/java/com/android/server/notification/SnoozeHelper.java",
            "patch_sha": "ade22bfdf6698cb97b4edc303e8952d6cc1a2f73",
            "reason": "Last Format Error: Invalid patch format: Hunk diff line expected: @@ -359,7 +362,10 @@\n, Last Apply Error: Skipped due to format error",
            "last_format_error": "Invalid patch format: Hunk diff line expected: @@ -359,7 +362,10 @@\n",
            "last_apply_error": "Skipped due to format error",
            "token_counts": {
                "input": 98649,
                "output": 9772,
                "total": 140054
            }
        },
        {
            "vulnerability_id": "ASB-A-353240784",
            "file_name": "services/appwidget/java/com/android/server/appwidget/AppWidgetServiceImpl.java",
            "patch_sha": "ae39a3f6538e5a5a73aea4daf8b552539247227f",
            "reason": "Last Format Error: Invalid patch format: Hunk diff line expected: @@ -3575,7 +3575,27 @@\n, Last Apply Error: Skipped due to format error",
            "last_format_error": "Invalid patch format: Hunk diff line expected: @@ -3575,7 +3575,27 @@\n",
            "last_apply_error": "Skipped due to format error",
            "token_counts": {
                "input": 209684,
                "output": 1828,
                "total": 258472
            }
        },
        {
            "vulnerability_id": "ASB-A-353240784",
            "file_name": "services/appwidget/java/com/android/server/appwidget/AppWidgetServiceImpl.java",
            "patch_sha": "ae39a3f6538e5a5a73aea4daf8b552539247227f",
            "reason": "Last Format Error: Invalid patch format: Hunk is longer than expected, Last Apply Error: Skipped due to format error",
            "last_format_error": "Invalid patch format: Hunk is longer than expected",
            "last_apply_error": "Skipped due to format error",
            "token_counts": {
                "input": 209690,
                "output": 1955,
                "total": 248128
            }
        },
        {
            "vulnerability_id": "ASB-A-353240784",
            "file_name": "services/appwidget/java/com/android/server/appwidget/AppWidgetServiceImpl.java",
            "patch_sha": "ae39a3f6538e5a5a73aea4daf8b552539247227f",
            "reason": "Last Format Error: Invalid patch format: Unexpected hunk found: @@ -2178,12 +2187,31 @@\n, Last Apply Error: Skipped due to format error",
            "last_format_error": "Invalid patch format: Unexpected hunk found: @@ -2178,12 +2187,31 @@\n",
            "last_apply_error": "Skipped due to format error",
            "token_counts": {
                "input": 209809,
                "output": 2017,
                "total": 251603
            }
        },
        {
            "vulnerability_id": "ASB-A-317048495",
            "file_name": "packages/SystemUI/src/com/android/systemui/clipboardoverlay/ClipboardListener.java",
            "patch_sha": "c7d1402707ea106b58fa9297585ae22d5c09d7f9",
            "reason": "Last Format Error: Invalid patch format: Hunk diff line expected: @@ -71,15 +76,18 @@\n, Last Apply Error: Skipped due to format error",
            "last_format_error": "Invalid patch format: Hunk diff line expected: @@ -71,15 +76,18 @@\n",
            "last_apply_error": "Skipped due to format error",
            "token_counts": {
                "input": 74524,
                "output": 2064,
                "total": 113089
            }
        },
        {
            "vulnerability_id": "ASB-A-309938635",
            "file_name": "ojluni/src/main/java/java/util/zip/ZipFile.java",
            "patch_sha": "c7b495dc8c466de602cd7b78468864acd6b2f9b3",
            "reason": "Last Format Error: Invalid patch format: Hunk is longer than expected, Last Apply Error: Skipped due to format error",
            "last_format_error": "Invalid patch format: Hunk is longer than expected",
            "last_apply_error": "Skipped due to format error",
            "token_counts": {
                "input": 96643,
                "output": 1348,
                "total": 131804
            }
        },
        {
            "vulnerability_id": "ASB-A-309938635",
            "file_name": "ojluni/src/main/java/java/util/zip/ZipFile.java",
            "patch_sha": "288a44a1817707110cdf5a3a6ef8377c6e10cce2",
            "reason": "Last Format Error: Invalid patch format: Hunk diff line expected: @@ -902,7 +913,7 @@\n, Last Apply Error: Skipped due to format error",
            "last_format_error": "Invalid patch format: Hunk diff line expected: @@ -902,7 +913,7 @@\n",
            "last_apply_error": "Skipped due to format error",
            "token_counts": {
                "input": 94950,
                "output": 1312,
                "total": 135330
            }
        },
        {
            "vulnerability_id": "ASB-A-313428840",
            "file_name": "services/companion/java/com/android/server/companion/CompanionDeviceManagerService.java",
            "patch_sha": "54c968aaa66e9364bc0380c9a57af5c6844759aa",
            "reason": "Last Format Error: Valid patch format, Last Apply Error: Patch failed in repo: checking file services/companion/java/com/android/server/companion/CompanionDeviceManagerService.java\nHunk #1 FAILED at 955.\n1 out of 1 hunk FAILED\npatch unexpectedly ends in middle of line",
            "last_format_error": "Valid patch format",
            "last_apply_error": "Patch failed in repo: checking file services/companion/java/com/android/server/companion/CompanionDeviceManagerService.java\nHunk #1 FAILED at 955.\n1 out of 1 hunk FAILED\npatch unexpectedly ends in middle of line",
            "token_counts": {
                "input": 115358,
                "output": 1150,
                "total": 147090
            }
        },
        {
            "vulnerability_id": "ASB-A-313428840",
            "file_name": "services/companion/java/com/android/server/companion/CompanionDeviceManagerService.java",
            "patch_sha": "eb68b0d423afb55159b1c02b0897f597c0905916",
            "reason": "Last Format Error: Valid patch format, Last Apply Error: Patch failed in repo: checking file services/companion/java/com/android/server/companion/CompanionDeviceManagerService.java\nHunk #1 FAILED at 81.\nHunk #2 FAILED at 734.\n2 out of 2 hunks FAILED\npatch unexpectedly ends in middle of line",
            "last_format_error": "Valid patch format",
            "last_apply_error": "Patch failed in repo: checking file services/companion/java/com/android/server/companion/CompanionDeviceManagerService.java\nHunk #1 FAILED at 81.\nHunk #2 FAILED at 734.\n2 out of 2 hunks FAILED\npatch unexpectedly ends in middle of line",
            "token_counts": {
                "input": 113923,
                "output": 1304,
                "total": 149769
            }
        },
        {
            "vulnerability_id": "ASB-A-313428840",
            "file_name": "services/companion/java/com/android/server/companion/CompanionDeviceManagerService.java",
            "patch_sha": "8d008c61451dba86aa9f14c6bcd661db2cea4856",
            "reason": "Last Format Error: Invalid patch format: Hunk is longer than expected, Last Apply Error: Skipped due to format error",
            "last_format_error": "Invalid patch format: Hunk is longer than expected",
            "last_apply_error": "Skipped due to format error",
            "token_counts": {
                "input": 113711,
                "output": 1357,
                "total": 147675
            }
        },
        {
            "vulnerability_id": "ASB-A-314333719",
            "file_name": "packages/SystemUI/src/com/android/systemui/media/dagger/MediaModule.java",
            "patch_sha": "007313b88e830ab9f0a8119406a61c89ca412fb5",
            "reason": "Last Format Error: Valid patch format, Last Apply Error: Patch failed in repo: checking file packages/SystemUI/src/com/android/systemui/media/dagger/MediaModule.java\nHunk #1 succeeded at 23 (offset 5 lines).\nHunk #2 FAILED at 43.\nHunk #3 succeeded at 100 with fuzz 1 (offset 9 lines).\npatch unexpectedly ends in middle of line\n1 out of 3 hunks FAILED\npatch unexpectedly ends in middle of line",
            "last_format_error": "Valid patch format",
            "last_apply_error": "Patch failed in repo: checking file packages/SystemUI/src/com/android/systemui/media/dagger/MediaModule.java\nHunk #1 succeeded at 23 (offset 5 lines).\nHunk #2 FAILED at 43.\nHunk #3 succeeded at 100 with fuzz 1 (offset 9 lines).\npatch unexpectedly ends in middle of line\n1 out of 3 hunks FAILED\npatch unexpectedly ends in middle of line",
            "token_counts": {
                "input": 73985,
                "output": 1075,
                "total": 111428
            }
        },
        {
            "vulnerability_id": "ASB-A-230492947",
            "file_name": "services/core/java/com/android/server/wm/ActivityTaskManagerService.java",
            "patch_sha": "d54a64bdf71d1c91542b6885149fd176622ad0b4",
            "reason": "Last Format Error: Invalid patch format: Hunk is longer than expected, Last Apply Error: Skipped due to format error",
            "last_format_error": "Invalid patch format: Hunk is longer than expected",
            "last_apply_error": "Skipped due to format error",
            "token_counts": {
                "input": 259826,
                "output": 2313,
                "total": 297374
            }
        },
        {
            "vulnerability_id": "ASB-A-230492947",
            "file_name": "services/core/java/com/android/server/wm/ActivityTaskManagerService.java",
            "patch_sha": "d54a64bdf71d1c91542b6885149fd176622ad0b4",
            "reason": "Last Format Error: Invalid patch format: Hunk is longer than expected, Last Apply Error: Skipped due to format error",
            "last_format_error": "Invalid patch format: Hunk is longer than expected",
            "last_apply_error": "Skipped due to format error",
            "token_counts": {
                "input": 259939,
                "output": 2480,
                "total": 289495
            }
        }
    ]
}